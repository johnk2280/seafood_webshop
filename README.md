# seafood_webshop
### Тестовое задание.
В аналитическое агентство обратилась администрация
интернет-магазина, который занимается продажей морепродуктов, с
просьбой провести аналитику потребности пользователей. В ходе исследования было
выявлено, что интернет-магазин не хранит информацию о действиях пользователей и
единственное, что удалось достать, это логи сервера.

#### Задание:
 - изучить логи сервера, спроектировать реляционную базу
данных, которая будет хранить информацию о товарах, транзакциях и действиях
пользователей;
 - распарсить логи и положить их в только что
спроектированную базу;
 - на основе полученной базы данных, необходимо разработать
программный модуль для генерации аналитических отчетов, которые будут отвечать на
следующие вопросы:
   1. Посетители из какой страны чаще всего посещают сайт?
   2. Посетители из какой страны чаще всего интересуются товарами из
определенной категории “fresh_fish”?
   3. В какое время суток чаще всего просматривают категорию “frozen_fish”?
   4. Какое максимальное число запросов на сайт за астрономический час (c 00
минут 00 секунд до 59 минут 59 секунд)?
   5. Товары из какой категории чаще всего покупают совместно с товаром из
категории “semi_manufactures”?
   6. Сколько не оплаченных корзин имеется?
   7. Какое количество пользователей совершали повторные покупки?

#### Применяемый стек:
- Python 3;
- Django 3.2;
- Django REST Framework 3.12
- SQLite3;
- swagger;
- GeoIP2.

### Инструкция установке на локальный хост.
1. Склонируйте репозиторий:
      
         $ git clone https://github.com/johnk2280/seafood_webshop.git
2. В корневой папке **seafood_webshop** установите виртуальное окружение.
3. Находясь в папке **seafood_webshop** установите зависимости:

         $ pip3 install -r requirements.txt
4. Перейдите в папку проекта:

         $ cd webshop/
5. И выполните миграции командой:
      
         $ python manage.py migrate
6. Если миграций не случилось и вылетело исключение, не обходимо удалить файл:
**/webshop/datarestorerapp/migrations/0001_initial.py**


7. Создать и выполнить миграции заново:

         $ python manage.py makemigratons

         $ python manage.py migrate
8. Создайте суперпользователя:

         $ python manage.py createsuperuser

9. Запустите проект (по умолчанию проект запускается на 8000 порту):

          $ python manage.py runserver

### Инструкция по использованию (локально):

1. После запуска приложения, передайте POST-запросом через Postman или cURL файл logs.txt на адрес:

   http://127.0.0.1:8000/api/v1/log_file_upload/


2. После загрузки файла станет доступна информация по БД в следующих ендпоинтах:

   http://127.0.0.1:8000/api/v1/shop_useers/
   http://127.0.0.1:8000/api/v1/products/
   http://127.0.0.1:8000/api/v1/product_categories/
   http://127.0.0.1:8000/api/v1/orders/
   http://127.0.0.1:8000/api/v1/order_items/
   http://127.0.0.1:8000/api/v1/shop_user_actions/

3. Сгенерированные отчеты можно получить перейдя на следующие ендпоинты:

   http://127.0.0.1:8000/api/v1/task_1/
   http://127.0.0.1:8000/api/v1/task_2/
   http://127.0.0.1:8000/api/v1/task_3/
   http://127.0.0.1:8000/api/v1/task_4/
   http://127.0.0.1:8000/api/v1/task_5/
   http://127.0.0.1:8000/api/v1/task_6/
   http://127.0.0.1:8000/api/v1/task_7/

### SWAGGER подключен по адресу http://127.0.0.1:8000.
